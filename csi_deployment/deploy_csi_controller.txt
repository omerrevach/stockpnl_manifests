1. in json policy file change to my account id

2. aws iam create-policy \
  --policy-name AmazonEKS_EBS_CSI_Driver_Policy \
  --policy-document file://ebs-csi-policy.json

3. # make sure to call the cluster name "stockpnl"
aws iam attach-role-policy \
  --policy-arn arn:aws:iam::123456789012:policy/AmazonEKS_EBS_CSI_Driver_Policy \
  --role-name stockpnl-eks-nodes


4. # install the aws ebs csi controller

helm repo add aws-ebs-csi-driver https://kubernetes-sigs.github.io/aws-ebs-csi-driver
helm repo update

helm upgrade --install aws-ebs-csi-driver \
  aws-ebs-csi-driver/aws-ebs-csi-driver \
  --namespace kube-system \
  --set serviceAccount.create=false \
  --set serviceAccount.name=ebs-csi-controller-sa

5. verify installation

kubectl get pods -n kube-system | grep ebs
